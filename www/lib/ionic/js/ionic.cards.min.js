(function(e){var t=document.createElement("div");var n=["webkitTransformOrigin","transform-origin","-webkit-transform-origin","webkit-transform-origin","-moz-transform-origin","moz-transform-origin","MozTransformOrigin","mozTransformOrigin"];var r="webkitTransformOrigin";for(var i=0;i<n.length;i++){if(t.style[n[i]]!==undefined){r=n[i];break}}var s=["webkitTransition","transition","-webkit-transition","webkit-transition","-moz-transition","moz-transition","MozTransition","mozTransition"];var o="webkitTransition";for(var i=0;i<s.length;i++){if(t.style[s[i]]!==undefined){o=s[i];break}}var u=e.views.View.inherit({initialize:function(e){this.cards=[];var t=window.innerWidth/window.innerHeight;this.maxWidth=window.innerWidth-(e.cardGutterWidth||0);this.maxHeight=e.height||300;this.cardGutterWidth=e.cardGutterWidth||10;this.cardPopInDuration=e.cardPopInDuration||400;this.cardAnimation=e.cardAnimation||"pop-in"},pushCard:function(e){var t=this;this.cards.push(e);this.beforeCardShow(e);e.transitionIn(this.cardAnimation);setTimeout(function(){e.disableTransition(t.cardAnimation)},this.cardPopInDuration+100)},beforeCardShow:function(){var e=this.cards[this.cards.length-1];if(!e)return;var t=window.innerHeight/2-this.maxHeight/2;var n=Math.min(this.cards.length,3)*5;e.setPopInDuration(this.cardPopInDuration);e.setZIndex(this.cards.length)},popCard:function(e){var t=this.cards.pop();if(e){t.swipe()}return t}});var a=e.views.View.inherit({initialize:function(t){t=e.extend({},t);e.extend(this,t);this.el=t.el;this.startX=this.startY=this.x=this.y=0;this.bindEvents()},setX:function(t){this.el.style[e.CSS.TRANSFORM]="translate3d("+t+"px,"+this.y+"px, 0)";this.x=t;this.startX=t},setY:function(t){this.el.style[e.CSS.TRANSFORM]="translate3d("+this.x+"px,"+t+"px, 0)";this.y=t;this.startY=t},setZIndex:function(e){this.el.style.zIndex=e},setWidth:function(e){this.el.style.width=e+"px"},setHeight:function(e){this.el.style.height=e+"px"},setPopInDuration:function(e){this.cardPopInDuration=e},transitionIn:function(e){var t=this;this.el.classList.add(e+"-start");this.el.classList.add(e);this.el.style.display="block";setTimeout(function(){t.el.classList.remove(e+"-start")},100)},disableTransition:function(e){this.el.classList.remove(e)},swipe:function(e){this.transitionOut(e)},transitionOut:function(t){var n=this;if(t===true||this.x>0){var r=this.rotationAngle+this.rotationDirection*.6||Math.random()*-.4;var i=this.rotationAngle?.2:.5;this.el.style[o]="-webkit-transform "+i+"s ease-in-out";this.el.style[e.CSS.TRANSFORM]="translate3d("+window.innerWidth*1.5+"px,"+this.y+"px, 0) rotate("+r+"rad)";this.onSwipe&&this.onSwipe();n.positive=true;setTimeout(function(){n.onDestroy&&n.onDestroy(true)},i*1e3)}else{var r=this.rotationAngle+this.rotationDirection*.6||Math.random()*.4;var i=this.rotationAngle?.2:.5;this.el.style[o]="-webkit-transform "+i+"s ease-in-out";this.el.style[e.CSS.TRANSFORM]="translate3d("+window.innerWidth*-1.5+"px,"+this.y+"px, 0) rotate("+r+"rad)";this.onSwipe&&this.onSwipe();n.positive=false;setTimeout(function(){n.onDestroy&&n.onDestroy()},i*1e3)}},bindEvents:function(){var t=this;e.onGesture("dragstart",function(e){var n=window.innerWidth/2;if(e.gesture.touches[0].pageX<n){t._transformOriginRight()}else{t._transformOriginLeft()}window._rAF(function(){t._doDragStart(e)})},this.el);e.onGesture("drag",function(e){window._rAF(function(){t._doDrag(e)})},this.el);e.onGesture("dragend",function(e){window._rAF(function(){t._doDragEnd(e)})},this.el)},_transformOriginLeft:function(){this.el.style[r]="left center";this.rotationDirection=1},_transformOriginRight:function(){this.el.style[r]="right center";this.rotationDirection=-1},_doDragStart:function(e){var t=this.el.offsetWidth;var n=window.innerWidth/2+this.rotationDirection*(t/2);var r=Math.abs(n-e.gesture.touches[0].pageY);this.touchDistance=r*10},_doDrag:function(t){var n=t.gesture.deltaX/3;this.rotationAngle=Math.atan(n/this.touchDistance)*this.rotationDirection;if(t.gesture.deltaX<0){this.rotationAngle=-this.rotationAngle}this.x=this.startX+t.gesture.deltaX*.4;this.el.style[e.CSS.TRANSFORM]="translate3d("+this.x+"px, "+this.y+"px, 0) rotate("+(this.rotationAngle||0)+"rad)"},_doDragEnd:function(e){this.transitionOut(e)}});angular.module("ionic.contrib.ui.cards",["ionic"]).directive("swipeCard",["$timeout",function(e){return{restrict:"E",template:'<div class="swipe-card" ng-transclude></div>',require:"^swipeCards",replace:true,transclude:true,scope:{onSwipe:"&",onDestroy:"&"},compile:function(t,n){return function(t,n,r,i){var s=n[0];var o=new a({el:s,onSwipe:function(){e(function(){t.onSwipe()})},onDestroy:function(){e(function(){t.onDestroy()})}});t.$parent.swipeCard=o;i.pushCard(o)}}}}]).directive("swipeCards",["$rootScope",function(e){return{restrict:"E",template:'<div class="swipe-cards" ng-transclude></div>',replace:true,transclude:true,scope:{},controller:function(t,n){var r=new u({});e.$on("swipeCard.pop",function(e){r.popCard(e)});return r}}}]).factory("$ionicSwipeCardDelegate",["$rootScope",function(e){return{popCard:function(t,n){e.$emit("swipeCard.pop",n)},getSwipebleCard:function(e){return e.$parent.swipeCard}}}])})(window.ionic)